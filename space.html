<!DOCTYPE HTML>
	<html>
	<head>
	<style>

<script src="../p5.min.js"></script>
 <script src="sketch.js"></script>
	</style>
	</head>
	<body>
	<canvas id="canvas" width="500" height="500" > </canvas>

	<script>
	
	 
	
	 var canvas = document.getElementById("canvas");
	 var ctx = canvas.getContext('2d');
	 var size = 20;
	 var statek = [];
	 var p = [];
	 var i=0;
	 var n=0;
	 var enemy = [];
	 var poc;
	 var pociski = [];
	 
	ctx.beginPath();
	ctx.fillStyle = "black";
	ctx.fillRect(0,0,500,500);
	
	function ship(x,y,size)
	{

	 this.x = x;
	 this.y = y;
	 this.dy=20;
	 this.dx=20;
	 
	ctx.fillStyle = "gray";
	ctx.fillRect(x,y,size,size);

	}
	
          function wrog(x, y, w, h, v, c) {
                this.x = x;
                this.y = y;
                this.width = w;
                this.height = h;
                this.vel = v;
                this.color = c;
                this.mTick = 1;
            }
			
			
     wrog.prototype.rysuj = function () {
         ctx.beginPath();
         ctx.fillStyle = this.color;
         ctx.fillRect(this.x, this.y, this.width, this.height);
     };
		
		
		
     wrog.prototype.strzal = function() {
         pociski.push( new pocisk(this.x + (this.width-bW)/2, this.y + this.height + 1, bW, bH, -bS, "pink", "e") );
     }
		
		
     wrog.prototype.moveE = function() {
         if(this.mTick % 7 == 0) {
             this.y += this.height;
             this.vel *= -1;
         }
         this.x += this.vel;
         this.mTick++;
     }
		
		
		
     var strzalInterval = setInterval(function() {
         wrogowie[random(0, wrogowie.length-1)].strzal();
     }, 450);
		
		
     var moveInterval = setInterval(function() {
         for (var j = 0; j < wrogowie.length; j++) {
             wrogowie[j].moveE();
         }
     }, 1200);
			
	
	
	
	statek[0] = new ship(240,480,20);
	statek[1] = new ship(220,480,20);
	statek[2] = new ship(260,480,20);
	statek[3] = new ship(240,460,20);
	


	
ship.prototype.lewo = function() 
	{
		this.x -= this.dx;
	
	}
	
ship.prototype.prawo = function() 
	{
	this.x += this.dx;
	
	}
		//poc = new pocisk(statek[3].x,statek[3].y-20);

	// ----- pocisk ---- //
	
	/* nowa budowa pocisku 
	
	            function pocisk(x, y, w, h, s, c, t = "") {
                this.x = x;
                this.y = y;
                this.width = w;
                this.height = h;
                this.predkosc = s;
                this.color = c;
                this.type = t;
            }
			
			
            pocisk.prototype.rysuj = function () {
                ctx.beginPath()
                ctx.fillStyle = this.color
                ctx.fillRect(this.x, this.y, this.width, this.height)
            };
			
			
            pocisk.prototype.odswiez = function () {
                this.y -= this.predkosc;
                if(dist(this.x, this.y, this.width, this.height, statek.x, statek.y, statek.width, statek.height)) {
                    this.width = null;
                    this.x = -10;
                    statek.zycia--;
                    statek.width -= 6;
                    statek.height -= 6;
                }
                for (var i = 0; i < wrogowie.length; i++) {
                    if(dist(this.x, this.y, this.width, this.height, wrogowie[i].x, wrogowie[i].y, wrogowie[i].width, wrogowie[i].height) && this.type != "e") {
                        this.width = null;
                        this.x = -10;
                        wrogowie.splice(i, 1)
                    }
                }
            };
	
	*/
	
	
	
	
function pocisk(x,y)
{
	this.x=x;
	this.y=y;
	this.r=10;
  
	this.pokaz = function()
	{ 
	  ctx.fillRect(this.x,this.y,20,20);	
	  ctx.fillStyle="gray";
	
	}
	
	this.ruch = function()
	{ 
	  this.y = this.y - 10;
	  ctx.fill();
	}	
	
    this.zderzenie = function(alien)
	{
	  var dist = dist(this.x,this.y,alien.x,alien.y);
	
	  if(dist < this.r + alien.r) return true;
	  else return false;
	
	}
	
	
}	
/////////////////
function rysuj()
{
	for(var t = 0 ; t < 6 ; t++)
    {enemy[t] = new alien(t*80+10 , 20);
	enemy[t].pokaz();}

	for(var t = 0; t< pociski.length; t++)
	{
	 pociski[t].pokaz();
	 pociski[t].ruch();
	 
	 for(var n = 0; n<alien.length; n++)
	  if(pociski[t].zderzenie(alien[n])) console.log("cos");
	 
	 
	}
	
}	
	
	
	
	
	document.onkeydown = checkKey;

 function checkKey(e) 
 {
 
	 e = e || window.event;
 

	 if (e.keyCode == '37') //lewo
	{
		ctx.fillStyle = "black";
		ctx.clearRect(0,460,500,40);
		ctx.fillRect(0,460,500,40);
		statek[0].lewo();
		statek[0] = new ship(statek[0].x,statek[0].y,size);		
		statek[1].lewo();
		statek[1] = new ship(statek[1].x,statek[1].y,size);
		statek[2].lewo();
		statek[2] = new ship(statek[2].x,statek[2].y,size);
		statek[3].lewo();
		statek[3] = new ship(statek[3].x,statek[3].y,size);
	 }
	 else if (e.keyCode == '39') //prawo
	{  
	   	ctx.fillStyle = "black";
		ctx.clearRect(0,460,500,40);
		ctx.fillRect(0,460,500,40);
		statek[0].prawo();
		statek[0] = new ship(statek[0].x,statek[0].y,size);		
		statek[1].prawo();
		statek[1] = new ship(statek[1].x,statek[1].y,size);
		statek[2].prawo();
		statek[2] = new ship(statek[2].x,statek[2].y,size);
		statek[3].prawo();
		statek[3] = new ship(statek[3].x,statek[3].y,size);
	 }
 
	 else if (e.keyCode == '32') // spacja
	{
		var bullet = new pocisk(statek[3].x,statek[3].y-20);
		pociski.push(bullet);
	}
 

}

	
	setInterval(rysuj,100);
	
	</script>

	</body>
	</html>